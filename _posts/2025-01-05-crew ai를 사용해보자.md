---
layout: post
title: "crew ai를 사용해보자"
date: 2025-01-05
categories: ai-agent, one-person-project
---

### 왜 사용해보려고 하는가?
아이디어는 많은데 잘 될지도 모르는 아이디어를 사람을 모으고 작업 하는 것 자체가 어렵다고 생각했다. 마치 토니스타크처럼 자비스에게 아이디어를 설명하고 토니는 다른 일을 하러 나가는 것처럼 결과물을 보고 어떻게 조정했으면 하는지, 이렇게 수정해보면 어떨지를 결정하고 그 일은 ai에게 시킬 수 있지 않을까? 라는 아이디어를 검증해보고자 시작했다.
### 방안은 crew ai
crew ai의 존재는 이전부터 알았지만, 느린 실행력 덕분에 드디어 각잡고 사용해보려고 한다.
주된 테스트들이 python으로 작성되어 있다. python이 익숙하지는 않기 때문에 천천히 진행하겠다.

프로젝트마다 필요한 디펜던시의 버전들이 다양하기 때문에 venv라는 것을 활용해서 각각 만들어 사용하는 것 같다.
[참고 crewai github](https://github.com/crewAIInc/crewAI)
#### 진행방식
1. python3 -m venv venv
2. pip install crewai
	- 난 여기서 환경이 안맞아서 좀 걸렸다.
	- rust 다운받고 사용하기
	- python의 버전이 너무 높아서 생기는 이슈였다. 2024/01/05 기준으로 tiktoken 이라는 dependency는 최신 버전과 맞지 않으니 python@3.11 으로 사용했다.

바로 프론트엔드의 코드를 찍어내는 테스트를 해보고 싶었지만, 너무 많이 실패해서 일단 프로젝트 생성시 만들어주는 것들에 대해서 정상적으로 처리되는지 확인해봤다.

여기서 배울 수 있었던 것은 agent와 task 라는 개념이었다.
테스트에서는 
- 데이터를 확인하는 사람과 데이터 분석가 agent
- research task와 reporting task
를 진행하는 것으로 확인했다.
#### 결과
carsharing socar에 대해 분석해보라고 요청했을 때,

![[스크린샷 2025-01-05 오후 6.44.06.png]]

```
1. 전기차 차량 확대 - 전체 차량의 60% 이상을 전기차로 전환하여 환경 친화적이고 비용 효율적인 서비스를 제공

2. 자율주행 기능 도입 - 일부 도시 지역에서 자율주행 카셰어링 서비스를 시작하여 혁신적인 이동 경험 제공

3. 대중교통과의 통합 - 버스, 지하철 등 대중교통과의 원활한 연계로 고객에게 종합적인 이동 솔루션 제공

4. 새로운 시장 확대 - 다수의 새로운 국가와 도시로 서비스를 확장하여 글로벌 카셰어링 기업으로 성장

5. 향상된 사용자 경험 - 모바일 앱과 인터페이스 개선을 통해 더욱 직관적이고 편리한 서비스 제공

6. 데이터 기반 의사결정 - 데이터 분석을 통해 차량 관리, 가격 책정, 고객 타겟팅을 최적화

7. 모빌리티 파트너십 - 다양한 이동 서비스 제공업체와의 협력으로 포괄적인 모빌리티 옵션 제공

8. 로열티 프로그램 개선 - 다양한 혜택과 게임화 요소를 도입하여 고객 충성도 강화

9. 차량 관리 발전 - 예측 정비와 실시간 모니터링으로 차량 관리 효율성과 신뢰성 향상

10. 사회적 책임 강화 - 환경 보호, 지역사회 참여, 직원 복지 등 기업의 사회적 책임 이행 확대
```
생각보다 괜찮게 분석하고 가져오는 것을 확인할 수 있었다.
이 데이터를 0.01$ 를 사용해서 시킬 수 있었음. -> 현재 환율 기준 14원

### 코드를 짜낼 수 있는지 테스트하고 구성해보자
먼저 agent에서 무엇을 설정하고 사용할 수 있을지 파악했다.
#### agent
- `agent_executor`: CrewAgentExecutor 클래스의 인스턴스입니다. 실제 에이전트의 실행을 담당합니다.
- `role`: 에이전트의 역할을 정의합니다. 예를 들어 "연구원", "작가", "분석가" 등을 지정할 수 있습니다.
- `goal`: 에이전트의 목표입니다. 에이전트가 달성해야 할 구체적인 목적을 설정합니다.
- `backstory`: 에이전트의 배경 이야기입니다. 에이전트의 전문성, 경험, 성격 등을 정의하는 데 사용됩니다.
- `knowledge`: 에이전트의 지식 기반입니다. 에이전트가 가지고 있는 기본 지식을 정의합니다.
- `config`: 에이전트 설정의 딕셔너리 표현입니다. 모든 설정값들을 포함합니다.
- `llm`: 에이전트가 사용할 언어 모델입니다. OpenAI GPT 등을 지정할 수 있습니다.
- `function_calling_llm`: 도구 호출을 처리할 언어 모델입니다. crew의 function_calling_llm을 재정의합니다.
- `max_iter`: 에이전트가 작업을 실행할 때의 최대 반복 횟수입니다.
- `memory`: 에이전트의 메모리 사용 여부를 설정합니다. 이전 대화나 작업 내용을 기억할지 결정합니다.
- `max_rpm`: 에이전트 실행 시 분당 최대 요청 수를 제한합니다.
- `verbose`: 상세 로깅 모드 활성화 여부입니다. 실행 과정의 자세한 로그를 출력할지 결정합니다.
- `allow_delegation`: 다른 에이전트에게 작업을 위임할 수 있는지 여부를 설정합니다.
- `tools`: 에이전트가 사용할 수 있는 도구들을 정의합니다.
- `step_callback`: 에이전트 실행의 각 단계 후에 실행될 콜백 함수를 지정합니다.
- `knowledge_sources`: 에이전트가 참조할 수 있는 지식 소스들을 정의합니다.

agent에서 설정할 수 있는 기능들은 이런 게 있다.
주로 role, goal, backstory, knowledge, verbose, tools 등을 사용할 것으로 보이고,
knowledge_sources, allow_delegation 요런 친구들도 쓸 수 있을 듯

tool 쪽을 보니 code를 생성할 수 있게 해주는 툴을 langChain에서 가져오거나, 다른 툴을 만들어서 사용할 수 있는 것으로 보인다. langChain으로 사용해서 만들 수 있도록 해보려 한다.

다음 목표는 **frontend 코드를 생성해주는 agent**를 만들어내는 것!